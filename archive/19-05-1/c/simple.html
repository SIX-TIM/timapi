<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <link href="../assets/css/vendors.css" rel="stylesheet">
  <link href="../assets/css/helppage.css" rel="stylesheet">
  <link href="res/css/lang_specific.css" rel="stylesheet">

  <title>TIM API documentation</title>
  <script src="../assets/js/vendors.js"></script>
  <script src="../assets/js/helppage.js"></script>
  <script src="../assets/js/guide.js"></script>
  <script src="../assets/js/tim_inject.js"></script>
  <script src="../assets/js/sdk_version.js"></script>
  <script src="../assets/js/config.js"></script>
  <script src="doc/api_version.js"></script>
</head>
<body class="simple" data-spy="scroll" data-target="#navScrollspy">
  <div class="container-fluid" id="content">
    <div>
      <nav id="navScrollspy">
        <div id="stageBanner">STAGING VERSION!</div>
        <div id="archiveBanner">ARCHIVED VERSION!<br><a href="../../../doc/index.html" id="currentLink">-&gt; link to current version</a></div>
        <div class="affix" data-spy="affix" id="navbar">
          <div id="projectname">TIM SDK</div>
          <div id="projectbrief">TIM API</div>
          <div id="vSep">&#160;</div>
          <div id="langSel">
            <ul class="langList">
              <li>
                <a class="lang_java" href="../java/simple.html">Java</a>
              </li>
              <li>
                <span style="color: gray">.NET</span>
              </li>
              <li>
                <a class="lang_swift" href="../swift/guide.html">Swift</a>
              </li>
              <li>
                <a class="lang_js" href="../js/simple.html">JavaScript</a>
              </li>
              <li>
                <a class="lang_c" href="../c/guide.html">C</a>
              </li>
            </ul>
          </div>
          <div id="guideDiv">
            <div id="guideTitle">Guide Selection<div class="close_icon" id="closeGuideSel"></div></div>
            <div id="guideSel"></div>
          </div>
          <div id="docTitle">Simple Implementation Guide</div>
          <ul class="nav">
          <li><a href="#simpleIntro">Introduction</a></li><li><a href="#usageLibrary">Library usage</a></li><li><a href="#usageSettings">Minimal Settings</a></li><li><a href="#simpleTransaction">Simple Transaction</a></li><li><a href="#simpleResponse">Simple Response Handling</a></li></ul>
          <div class="seperator">&#160;</div>
          <div id="docLinks">
          <div class="linkDiv"><a href="guide.html">Detailed Implementation Guide</a></div><div class="linkDiv"><a href="appendix.html">Appendix</a></div><div class="linkDiv"><a href="doc/index.html">API Documentation</a></div><div class="linkDiv"><a href="../../version/version-history.html">Version History</a></div></div>
        </div>
      </nav>

      <div id="titleFloating">
          <div><a href="guide.html" id="linkOtherGuide">go to Detailed Implementation Guide</a></div>
          <div id="lblDiv">Simple Implementation Guide</div>
      </div>

      <span class="print-page-break"></span>

      <main>
      <section><h1><a id="simpleIntro" name="simpleIntro">&#160;</a>Introduction</h1><div class="row"><div class="col-md-6"><p>The following sections give a simple overview how to make a simple TIM API integration
      without any special configurations. Therefore default values are used as often as possible to keep it simple.
      If special features are required, visit the section <a href="guide.html">Integration in Detail</a>
      for a more sophisticated overview.
    </p>
  </div></div></section>
  <section><h1><a id="usageLibrary" name="usageLibrary">&#160;</a>Library usage</h1><div class="row"><div class="col-md-6"><p>As the TIM SDK offers the TIM API in multiple languages you can chose the one that is suitable for your platform.
      To use the TIM API <span lang="C">C you have to import the <b>Header-Files and LIB-File/DLL-File (on Windows) or so-File (on Unix)</b></span>
      <span lang="C Java Swift">into your project in the programming environment you are using. The file include path may have to be adjusted accordingly,
        depending where you place the TIM API.</span> </p>
          </div></div></section>
          <section><h1><a id="usageSettings" name="usageSettings">&#160;</a>Minimal Settings</h1><div class="row"><div class="col-md-6"><p>To start right away only a minimal set of settings has to be given:
              <ul> <li lang="Java Swift C">Terminal ID: The ID of the terminal that shall be used afterwards. Used for broadcast connection (Default).</li>
                <li>Terminal IP: The IP of the terminal that shall be used afterwards. Used if direct connection is used: ConnectionMode = OnFixIp</li>
                <li lang="Java Swift C">ConnectionMode: Only if "OnFixIp" with set Terminal IP shall be used. (Default: ConnectionMode = Broadcast)
                </li>
                <li><code><a href="doc/terminal__settings_8h.html#a2be8b19ae60811461776046761f7e4c5">auto_commit</a></code>: Defines if terminal performs a Commit automatically or if it must be done from the ECR. (Default: AutoCommit = true)</li>
              </ul>
            </p>
            <p>This minimal configuration can be done directly in the code after creating a<code><a href="doc/terminal__settings_8h.html">terminal_settings</a></code> instance.</p>
            </div></div><div class="row"><div class="col-md-6">
                <p lang="Java Swift C">This block shows the minimal setup with broadcast connection mode:
                  <pre><code></code></pre> </p>
                  <p>This block shows the setup with the fixed ip connection mode:
                    <pre><code></code></pre> </p>
                    <p>After the Terminal instance has been created it can be used to perform transactions.</p>
                  </div><div class="col-md-6">
                    </div></div>
              <div class="row"><div class="col-md-6"></div></div></section>
              <section><h1><a id="simpleTransaction" name="simpleTransaction">&#160;</a>Simple Transaction</h1><div class="row"><div class="col-md-6">
                    <p>
                      The flow on the right shows a simple transaction flow and which steps are done by which participant.
                      Note that for a simple use the integrator only needs to follow 4 simple steps, steps 1 to 4. Steps 1-4 can be performed multiple times (loop) if wished.
                      The rest, steps A to G, will be done either by the TIM API itself or by the terminal if required.
                    </p>
                    <p>
                      The steps the integrator has to perform are the following:
                      <ul>
                        <li><b>1. Start transaction: </b>The integrator has to call the <code><a href="doc/terminal_8h.html#a1989dbd83629a0d617e76d3e79b42735">transaction_async</a></code> function including the required parameters which are shown in the code example below.
                      </li>
                      <li><b>2. Process transaction completed: </b>After processing the transaction the TIM API will return a <code><a href="doc/transaction__response_8h.html">transaction_response</a></code>in the corresponding <code><a href="doc/terminal__listener_8h.html#acb4d8efc06602d461d8c634e92cca491">transaction_completed</a></code> callback method.
                    </li>
                    <li><b>3. Send commit (if AutoCommit deactivated): </b>After receiving the feedback in the transactionCompleted callback the integrator has to call the <code><a href="doc/terminal_8h.html#ac28f0dfe2dd8d093536c8a9e57f8423f">commit_async</a></code> function to complete the transaction process.
                    This step must only be done if AutoCommit has been set to "false" in the terminal settings.
                  </li>
                  <li><b>4. Process commit completed (if AutoCommit deactivated): </b>Also the commit function is finished from the TIM API by calling the <code><a href="doc/terminal__listener_8h.html#a89b6799427e9efb30136d13bc6eb84e5">commit_completed</a></code> callback function.
                  After getting the commit completed callback call from the TIM API, another requests, e.g. another transaction, can be called.
                </li>
              </ul>
            </p>
            <p>
              The following steps are performed by the TIM API or the terminal if they are required:
              <ul>
                <li><b>A.</b> : The TIM API automatically connects to the terminal and makes the required Login to set the
                specified connection parameters. If successful a shift will be opened on the terminal by calling Activate from the TIM API automatically.
                These steps are only performed if they are required which means the terminal was not yet in the corresponding state and not yet ready to accept a transaction:
                <ul>
                  <li>If the terminal is already connected, no connect is required.</li>
                  <li>If the terminal is already in LoggedIn state, no login is required.</li>
                  <li>If the terminal is already in Activated state (open shift), no activate is required.</li>
                </ul>
              </li>
              <li><b>B.</b> : After the TIM API performed all steps needed to bring the terminal into the required state, the transaction request
              is sent to the terminal.
            </li>
            <li><b>C.</b> : The terminal performs the transaction (e.g. cardholder verification, transaction authorization etc.)
          </li>
          <li><b>D.</b> : The terminal returns the outcome of the transaction to the TIM API.
        </li>
        <li><b>E.</b> : The TIM API sends the commit request to the terminal (will be done automatically, if AutoCommit is activated).
      </li>
      <li><b>F.</b> : The terminal processes the commit request.
    </li>
    <li><b>G.</b> : The terminal sends the commit response to the TIM API.
  </li>
</ul>
</p>
<p>In code this may look as follows:</p>
</div><div class="col-md-6">
  <figure><img src="../assets/img/QuickTrxFlow_v6.png"><figcaption>Simple Transaction Flow</figcaption></figure>
</div></div>
<div class="row"><div class="col-md-6"></div></div></section>
<section><h1><a id="simpleResponse" name="simpleResponse">&#160;</a>Simple Response Handling</h1><div class="row"><div class="col-md-6">
      <p>The following section explains how to easily retrieve response data from the which is available after a transaction as described above.</p>
        <p>The first step is to implement your own terminal listener class wherein you overwrite the functions you want to use.
          If you are mainly interested in the transaction response you can use the following code:</p>
          <pre><code class="language-{.c}">/*
 * Example for adding a terminal status listener
 *
 * \param[in] terminal Terminal instance
 */
void add_status_listener(ta_object_t terminal) {
    ta_object_t listener = ta_object_invalid;
    ta_s_terminal_listener_t listener_config;

    // clear listener-config
    memset(&amp;amp;listener_config, 0, sizeof(listener_config));

    // add user-implemented callback to listener-config
    listener_config.terminal_status_changed = mylistener_terminal_status_changed;

    // optional: add user content to listener,
    // pointer will be handed over to all callbacks:
    //listener_config.user_pointer = &amp;amp;custom_struct;

    // create listener-object
    ta_terminal_listener_create(&amp;amp;listener, &amp;amp;listener_config);

    // add listener-object to terminal
    ta_terminal_add_listener(terminal, listener);

    // release listener-object
    ta_object_release(listener);
}

/*
 * Callback for terminal status changes
 *
 * Will be called when status of terminal changes.
 * \param[in] terminal Terminal instance
 * \param[in] user_pointe User-pointer which can be set in the terminal listener
 */
void mylistener_terminal_status_changed(ta_object_t terminal,	void *user_pointer) {

	// implement your code to process status change here...
	//printf(&amp;quot; &amp;gt; listener_terminal_status_changed\n&amp;quot;);
}</code></pre>
          <h2>Check transaction outcome</h2>
          <p>To check if a transaction has been performed successfully you have to check the <code><a href="doc/result__code_8h.html#aebaf00d1ceef4b827866ca9de0bd3320">result_code</a></code>which is part of the <code><a href="doc/structta__s__event.html">event</a></code> object in the <code><a href="doc/terminal__listener_8h.html#acb4d8efc06602d461d8c634e92cca491">transaction_completed</a></code> callback.</p>
          <p>Further error information can be retrieved as described in the API documentation in the <code><a href="doc/result__code_8h.html#aebaf00d1ceef4b827866ca9de0bd3320">result_code</a></code> section.</p>
            <hr>
            <h2>Print data</h2>
            <p>
              The <code><a href="doc/transaction__response_8h.html">transaction_response</a></code> has a member <code><a href="doc/print__data_8h.html">print_data</a></code>
              (accessed via <code><a href="doc/transaction__response_8h.html#a3da2e80a13e8c606ae6ca70785525be9">get_print_data</a></code>) which contains merchant and cardholder receipts.
            </p>
            <p>The <code><a href="doc/print__data_8h.html">print_data</a></code> returned in the
            <code><a href="doc/transaction__response_8h.html">transaction_response</a></code> contains a merchant and
            a cardholder receipt which can be retrieved in the <code><a href="doc/terminal__listener_8h.html#acb4d8efc06602d461d8c634e92cca491">transaction_completed</a></code>
            callback using the <code><a href="doc/transaction__response_8h.html#a3da2e80a13e8c606ae6ca70785525be9">get_print_data</a></code> function. The <code><a href="doc/print__data_8h.html">print_data</a></code> object
            then contains a list of <code><a href="doc/receipt_8h.html">receipt</a></code> objects which can be retrieved individually.</p>
            <hr>
            <h2>Card data</h2>
            <p>To retrieve card specific information the <code><a href="doc/card__data_8h.html">card_data</a></code> object is also available in
            the <code><a href="doc/transaction__response_8h.html">transaction_response</a></code>. This object contains several card information that
            was available to the terminal during the transaction process.</p>
            <hr>
            <h2>Further transaction information</h2>
            <p>Further information regarding the transaction can be found in the <code><a href="doc/transaction__information_8h.html">transaction_information</a></code> object.</p>
          </div><div class="col-md-6">
            <p>The following code shows how the information mentioned above can be retrieved in the
              <code><a href="doc/terminal__listener_8h.html#acb4d8efc06602d461d8c634e92cca491">transaction_completed</a></code> event:</p>
              </div></div>
        <div class="row"><div class="col-md-6"></div></div></section>
      </main>
    </div>
  </div>
</body>

</html>